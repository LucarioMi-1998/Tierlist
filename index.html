<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tier List ‚Äì S/A/B/C/D</title>
  <style>
  :root{
    --bg: #0f1115;
    --panel: #161a22;
    --muted: #8b93a7;
    --text: #e8ebf1;
    --accent: #7aa2f7;
    --accent-2: #c0e57b;
    --danger: #ff6b6b;
    --radius: 12px;
    --gap: 12px;
    --shadow: 0 6px 18px rgba(0,0,0,.25);
    --row-h: 120px;
    --label-w: 90px;
  }

  * { box-sizing: border-box; }
  html,body{ height:100%; }
  body{
    margin:0; background:var(--bg); color:var(--text);
    font: 15px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  }

  .topbar{
    position:sticky; top:0; z-index:10;
    display:flex; align-items:center; justify-content:space-between;
    padding:16px; background: linear-gradient(to bottom, #0f1115, rgba(15,17,21,.6));
    border-bottom: 1px solid #1f2430;
    backdrop-filter: blur(6px);
  }
  .topbar h1{ margin:0; font-size:20px; letter-spacing:.3px; }
  .actions{ display:flex; gap:8px; flex-wrap:wrap; }
  button,.import-btn{
    background:var(--panel); color:var(--text); border:1px solid #262c39;
    padding:8px 12px; border-radius:10px; cursor:pointer; box-shadow: var(--shadow);
    font-size:14px;
  }
  button:hover,.import-btn:hover{ border-color:var(--accent); }
  button.danger{ border-color: var(--danger); }
  .import-btn{ display:inline-grid; place-items:center; }

  #board-wrapper{
    display:grid; grid-template-columns: 1fr minmax(270px, 360px);
    gap: var(--gap); padding: var(--gap);
  }
  @media (max-width: 980px){
    #board-wrapper{ grid-template-columns: 1fr; }
    .sidebar{ position:static; }
  }

  #board{
    display:flex; flex-direction:column; gap: var(--gap);
  }

  .tier{
    display:grid; grid-template-columns: var(--label-w) 1fr;
    background:var(--panel); border:1px solid #222736; border-radius: var(--radius);
    overflow:hidden; box-shadow: var(--shadow); min-height: var(--row-h);
  }
  .tier .label{
    display:flex; align-items:center; justify-content:center; font-weight:700;
    border-right:1px solid #222736; user-select:none;
  }
  .tier[data-tier="S"] .label{ background:#ffb3c7; color:#2b0b15; }
  .tier[data-tier="A"] .label{ background:#ffd59e; color:#2a1500; }
  .tier[data-tier="B"] .label{ background:#fff0a8; color:#2a2600; }
  .tier[data-tier="C"] .label{ background:#c8f7c5; color:#07200b; }
  .tier[data-tier="D"] .label{ background:#b3e1ff; color:#062233; }

  .dropzone{
    display:flex; flex-wrap:wrap; align-items:flex-start; align-content:flex-start;
    gap: var(--gap); padding: var(--gap);
    min-height: calc(var(--row-h) - 2px);
  }
  .dropzone.drag-over{ outline:2px dashed var(--accent); outline-offset:-6px; }

  .tile{
    display:flex; align-items:center; gap:10px;
    background:#0c0f14; border:1px solid #283143; border-radius:10px;
    padding:8px 10px; cursor:grab; min-width:140px; max-width:240px;
    box-shadow: var(--shadow);
    touch-action:none;
  }
  .tile:active{ cursor:grabbing; }
  .tile img{
    width:40px; height:40px; object-fit:cover; border-radius:6px; border:1px solid #1f2736;
    background:#151a24;
  }
  .tile .title{ font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

  .sidebar{
    display:flex; flex-direction:column; gap:16px; position:sticky; top:64px; align-self:start;
  }
  .sidebar h2,h3{ margin:0 0 6px; font-size:16px; color:var(--accent-2); }
  form#form-add{
    display:grid; gap:10px; background:var(--panel); padding:12px; border-radius: var(--radius);
    border:1px solid #222736; box-shadow: var(--shadow);
  }
  form label{ display:grid; gap:6px; color: var(--muted); font-size:14px;}
  input[type="text"],input[type="url"],input[type="file"]{
    background:#0c0f14; color:var(--text); border:1px solid #283143; border-radius:8px;
    padding:10px; outline:none;
  }
  input:focus{ border-color: var(--accent); }
  form button[type="submit"]{
    background: linear-gradient(180deg, #1e2636, #141a27);
    border:1px solid #2a3652; color:var(--text); padding:10px 12px; border-radius:10px;
  }

  .tile-list{ display:flex; flex-wrap:wrap; gap: var(--gap); }
  .trash{
    text-align:center; padding:16px; border:1px dashed #3a4257; border-radius:12px; color:#b6bed3;
  }
  .trash.drag-over{ border-color: var(--danger); color: #ffd7d7; }

  .footer{
    opacity:.7; text-align:center; padding:24px; font-size:13px; color:var(--muted);
  }

  /* F√ºr sauberen PNG-Export die Sidebar ausblenden */
  .exporting .sidebar, .exporting .topbar, .exporting .footer { display:none !important; }
  .exporting #board-wrapper{ grid-template-columns: 1fr; }
  </style>

  <script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>Tier List</h1>
    <div class="actions">
      <button id="btn-export-png">Export PNG</button>
      <button id="btn-export-json">Export JSON</button>
      <label class="import-btn">
        Import JSON
        <input type="file" id="input-import-json" accept="application/json" hidden />
      </label>
      <button id="btn-reset" class="danger">Reset</button>
    </div>
  </header>

  <main id="board-wrapper">
    <section id="board"></section>
    <aside class="sidebar">
      <h2>Neues Item</h2>
      <form id="form-add" autocomplete="off">
        <label>Titel<input type="text" id="item-title" required /></label>
        <label>Bild (optional)<input type="file" id="item-image" accept="image/*" /></label>
        <label>oder Bild-URL<input type="url" id="item-image-url" /></label>
        <button type="submit">Hinzuf√ºgen</button>
      </form>
      <div class="palette">
        <h3>Palette</h3>
        <div id="palette-list" class="tile-list"></div>
      </div>
      <div class="trash" id="trash">üóëÔ∏è Hierher ziehen zum L√∂schen</div>
    </aside>
  </main>
  <footer class="footer">Made for GitHub Pages ¬∑ Drag & Drop ¬∑ Offline</footer>

  <script>
  const TIER_ORDER = ["S","A","B","C","D"];
  const STORAGE_KEY = "tierlist-state-v1";
  let state = { items:{}, tiers:Object.fromEntries(TIER_ORDER.map(t=>[t,[]])), palette:[] };

  const $=(s,r=document)=>r.querySelector(s);
  const uid=()=> 'i'+Math.random().toString(36).slice(2,9)+Date.now().toString(36);

  function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
  function load(){ const raw=localStorage.getItem(STORAGE_KEY); if(!raw)return;
    try{const d=JSON.parse(raw); if(d.items) state=d;}catch{} }

  function createTile(item){
    const el=document.createElement('div'); el.className='tile'; el.draggable=true; el.dataset.id=item.id;
    const img=document.createElement('img'); img.src=item.imgSrc||''; img.alt='';
    const title=document.createElement('div'); title.className='title'; title.textContent=item.title;
    el.append(img,title);
    el.addEventListener('dragstart',ev=>{ev.dataTransfer.setData('text/plain',item.id);});
    return el;
  }

  function renderAll(){
    const board=$('#board'); board.innerHTML='';
    for(const tier of TIER_ORDER){
      const row=document.createElement('div'); row.className='tier'; row.dataset.tier=tier;
      const label=document.createElement('div'); label.className='label'; label.textContent=tier;
      const drop=document.createElement('div'); drop.className='dropzone'; drop.dataset.tier=tier;
      for(const id of state.tiers[tier]) drop.append(createTile(state.items[id]));
      addDropHandlers(drop,id=>moveToTier(id,tier));
      row.append(label,drop); board.append(row);
    }
    const pal=$('#palette-list'); pal.innerHTML='';
    for(const id of state.palette) pal.append(createTile(state.items[id]));
    addDropHandlers(pal,id=>moveToPalette(id));
    addDropHandlers($('#trash'),id=>removeItem(id));
  }

  function addDropHandlers(zone,onDrop){ zone.addEventListener('dragover',ev=>{ev.preventDefault(); zone.classList.add('drag-over');});
    zone.addEventListener('dragleave',()=>zone.classList.remove('drag-over'));
    zone.addEventListener('drop',ev=>{ev.preventDefault(); zone.classList.remove('drag-over'); onDrop(ev.dataTransfer.getData('text/plain'));});
  }
  function moveToTier(id,tier){ for(const t of TIER_ORDER) state.tiers[t]=state.tiers[t].filter(x=>x!==id); state.palette=state.palette.filter(x=>x!==id); state.tiers[tier].push(id); save(); renderAll(); }
  function moveToPalette(id){ for(const t of TIER_ORDER) state.tiers[t]=state.tiers[t].filter(x=>x!==id); if(!state.palette.includes(id)) state.palette.push(id); save(); renderAll(); }
  function removeItem(id){ delete state.items[id]; for(const t of TIER_ORDER) state.tiers[t]=state.tiers[t].filter(x=>x!==id); state.palette=state.palette.filter(x=>x!==id); save(); renderAll(); }
  async function addItem({title,file,url}){ let imgSrc=''; if(file){imgSrc=await fileToDataURL(file);} else if(url){imgSrc=url;} const id=uid(); state.items[id]={id,title,imgSrc}; state.palette.push(id); save(); renderAll(); }
  function fileToDataURL(file){ return new Promise(res=>{const r=new FileReader(); r.onload=()=>res(r.result); r.readAsDataURL(file);}); }
  async function exportPNG(){ document.body.classList.add('exporting'); await new Promise(r=>setTimeout(r,50)); const c=await html2canvas($('#board'),{backgroundColor:'#0f1115',scale:2}); document.body.classList.remove('exporting'); downloadURL(c.toDataURL(),'tierlist.png'); }
  function exportJSON(){ const blob=new Blob([JSON.stringify(state)],{type:'application/json'}); downloadURL(URL.createObjectURL(blob),'tierlist.json'); }
  function downloadURL(url,fn){ const a=document.createElement('a'); a.href=url;a.download=fn;document.body.append(a);a.click();a.remove(); }
  function importJSONFile(f){ const r=new FileReader(); r.onload=()=>{try{state=JSON.parse(r.result); save(); renderAll();}catch{alert('Import fehlgeschlagen');}}; r.readAsText(f); }
  function resetAll(){ if(confirm('Alles l√∂schen?')){ state={items:{},tiers:Object.fromEntries(TIER_ORDER.map(t=>[t,[]])),palette:[]}; save(); renderAll(); }}

  window.addEventListener('DOMContentLoaded',()=>{
    load(); renderAll();
    $('#btn-export-png').onclick=exportPNG;
    $('#btn-export-json').onclick=exportJSON;
    $('#btn-reset').onclick=resetAll;
    $('#input-import-json').onchange=ev=>{if(ev.target.files[0]) importJSONFile(ev.target.files[0]);};
    $('#form-add').onsubmit=async ev=>{ev.preventDefault(); await addItem({title:$('#item-title').value,file:$('#item-image').files[0],url:$('#item-image-url').value}); ev.target.reset();};
  });
  </script>
</body>
</html>